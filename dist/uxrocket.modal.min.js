/*! UX Rocket Modal 
 *  Modal Plugin 
 *  @author Bilal Cinarli <bcinarli@gmail.com> (http://bcinarli.com/) 
 *  @version 1.3.1 
 *  @build Wed Oct 28 2015 15:04:32 GMT+0300 (EEST) 
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports&&"function"==typeof require?jQuery:jQuery)}(function(e){var t,o="uxrModal",n=1,s='<div id="uxr-modal-overlay"></div>',i='<div id="{{id}}" class="uxr-modal-container uxr-modal-loading">    <div class="uxr-modal-drag uxr-modal-hide"></div>    <div class="uxr-modal-content">        <div class="uxr-modal-loaded-content"></div>    </div>    <a href="#" class="uxr-modal-close uxr-modal-hide"></a></div>',a={},c={className:"",href:"",width:"",height:"",maxWidth:"",maxHeight:"",appendTo:"body",allowMultiple:!1,blockUI:!0,overlayClose:!0,close:!0,iframe:!1,html:!1,fixed:!1,onReady:!1,onOpen:!1,onStart:!1,onLoad:!1,onClose:!1,onRemove:!1},l={click:"click."+o,wresize:"resize."+o,touchstart:"touchstart."+o,toucemove:"touchmove."+o,touchend:"touchend."+o,mousedown:"mousedown."+o,mousemove:"mousemove."+o,mouseup:"mouseup."+o,open:"uxropen."+o,start:"uxrstart."+o,load:"uxrload."+o,close:"uxrclose."+o,ready:"uxrready."+o,resize:"uxrresize."+o,remove:"uxrremove."+o},r={prefix:"uxr-",rocket:"uxRocket",data:o,name:"modal",classes:{ready:"ready",overlay:"overlay",container:"container",drag:"drag",content:"content",loadedContent:"loaded-content",loading:"loading",close:"close",hide:"hide"}},h=function(t,s,i){this._name=o,this._defaults=c,this._instance=n,this._direct=!1,null===t&&(t=document.createElement("a"),this._direct=!0),this.el=t,this.$el=e(t),this.$content=null,this.options=e.extend(!0,{},c,s,this.$el.data()),this.href=this.options.href||this.$el.attr("href")||!1,this.selector=i,n++,this.init()};h.prototype.init=function(){var e=this.$el.data(r.rocket)||{};e[r.data]={hasWrapper:!1,ready:p.getClassname("ready"),selector:this.selector,options:this.options},this.$el.data(r.rocket,e),this.bindUIActions(),this.$el.addClass(p.getClassname("ready")),this.emitEvent("ready"),this._direct===!0&&this.prepare()},h.prototype.bindUIActions=function(){var t=this;this.$el.on(l.click,function(e){e.preventDefault(),"undefined"==typeof a[t._instance]&&t.prepare()}).on(l.ready,function(){t.onReady()}).on(l.open,function(){t.onOpen()}).on(l.start,function(){t.onStart()}).on(l.load,function(){t.onLoad()}).on(l.close,function(){t.onClose()}).on(l.remove,function(){t.onRemove()}),e("body").on(l.click+" "+l.touchstart,"#uxr-modal-overlay",function(){d.closeFromOverlay()}).on(l.click+" "+l.touchstart,"#uxr-modal-instance-"+t._instance+" ."+p.getClassname("close"),function(e){e.preventDefault(),t.close()}).on(l.mousedown+" "+l.touchstart,"#uxr-modal-instance-"+t._instance+" ."+p.getClassname("drag"),function(e){e.preventDefault(),d.move.start(t,e)}),e(document).on(l.mousemove+" "+l.touchmove,function(e){d.move.drag(e)}).on(l.mouseup+" "+l.touchend,function(){d.move.stop()}),e(window).on(l.wresize,function(){void 0!==a[t._instance]&&t.resize()})},h.prototype.unbindUIActions=function(){this.emitEvent("remove"),this.$el.off("."+o)},h.prototype.prepare=function(){var t={},o=e("#uxr-modal-overlay"),n=i.replace("{{id}}","uxr-modal-instance-"+this._instance),a="body";this.emitEvent("start"),"body"!==this.options.appendTo&&(a=0===e(p.escapeSelector(this.options.appendTo)).length?"body":this.options.appendTo),!this.options.allowMultiple&&d.isOnlyInstance()&&d.closeFromOverlay(),this.options.blockUI&&(0===o.length?e(p.escapeSelector(a)).append(s):o.removeClass(p.getClassname("hide"))),null===this.$content?(this.$content=e(n),this.options.fixed&&(t.position="fixed"),""!==this.options.maxWidth&&(t.maxWidth=this.options.maxWidth),""!==this.options.maxHeight&&(t.maxHeight=this.options.maxHeight),Object.keys(t).length>0&&this.$content.css(t),e(p.escapeSelector(a)).append(this.$content)):this.$content.removeClass(p.getClassname("hide")),this.$content.addClass(p.getClassname("loading")).find("."+p.getClassname("loadedContent")).html(""),d.registerInstance(this),this.open()},h.prototype.open=function(){this.emitEvent("open"),this.get()},h.prototype.get=function(){var t,o=this;if(this.options.iframe)this.options.width=this.options.width||800,this.options.height=this.options.height||600,t='<iframe src="'+this.href+'" frameborder="0" width="100%" height="100%"></iframe>',this.html=t,o.emitEvent("load");else if(this.isInpage())if(this.href!==!1){var n=e(p.escapeSelector(this.href)),s=e("<div>").addClass("."+p.getClassname("hide")).insertBefore(n),i=null!==this.el?this.$el:e(document);i.one(l.close,function(){s.replaceWith(n)}),this.html=n,o.emitEvent("load")}else this.html=this.options.html,o.emitEvent("load");else e.get(this.href).done(function(e){o.html=e,setTimeout(function(){o.emitEvent("load")})})},h.prototype.load=function(){var e=this.$content.find("."+p.getClassname("loadedContent"));e.html(""),this.$content.removeClass(p.getClassname("loading")),this.options.close&&this.$content.find("."+p.getClassname("close")).removeClass(p.getClassname("hide")),this.options.allowMultiple&&this.$content.find("."+p.getClassname("drag")).removeClass(p.getClassname("hide")),e.append(this.html),this.resize()},h.prototype.close=function(){d.isOnlyInstance()&&e("#uxr-modal-overlay").addClass(p.getClassname("hide")),this.$content.addClass(p.getClassname("hide")).find("."+p.getClassname("close")).addClass(p.getClassname("hide")),d.close(this),this.emitEvent("close")},h.prototype.resize=function(){var e,t,o,n={},s=this.$content.find("."+p.getClassname("content")),i=this.$content.find("."+p.getClassname("loadedContent"));s.height("auto"),e=this.$content.height(),""!==this.options.width&&(n.width=this.options.width),""!==this.options.height&&(n.height=this.options.height),i.css(n),t=i.css("position","absolute").width(),o=i.height(),i.css("position","relative"),o>e&&s.width()<t?(s.height(e),s.css("overflow","scroll")):o>e?(s.height(e),s.css("overflowY","scroll")):s.width()<t&&s.css("overflowX","scroll"),this.emitEvent("resize")},h.prototype.isInpage=function(){if("undefined"==typeof this.inpage)if(this.inpage=!1,this.href===!1)this.inpage=!0;else if("#"===this.href.charAt(0))this.inpage=!0;else{var e=window.location.href.replace(location.hash,"").replace(location.protocol,""),t=this.href.replace(location.hash,"").replace(location.protocol,"");e===t&&(this.inpage=!0)}return this.inpage},h.prototype.remove=function(){this.removeClasses(),this.removeContent(),this.unbindUIActions(),this.removeInstance()},h.prototype.removeClasses=function(){this.$el.removeClass(p.getClassname("ready"))},h.prototype.removeContent=function(){null!==this.$content&&this.$content.remove()},h.prototype.removeInstance=function(){delete this.$el.data()[r.data],delete this.$el.data(r.rocket)[r.data]},h.prototype.onReady=function(){p.callback(this.options.onReady)},h.prototype.onOpen=function(){p.callback(this.options.onOpen)},h.prototype.onStart=function(){p.callback(this.options.onStart)},h.prototype.onLoad=function(){this.load(),p.callback(this.options.onLoad)},h.prototype.onClose=function(){p.callback(this.options.onClose)},h.prototype.onRemove=function(){p.callback(this.options.onRemove)},h.prototype.emitEvent=function(t){this.$el.trigger(l[t]),this._direct&&e(document).trigger(l[t])},h.prototype.getOpenedInstances=function(){return a};var d={registerInstance:function(e){a[e._instance]=e,e.previousInstance=d.isOnlyInstance()?e:a.lastInstance||e,a.lastInstance=e},close:function(e){a.lastInstance=e.previousInstance,delete a[e._instance]},closeFromOverlay:function(){var e=a.lastInstance;if(this.hasInstances()){if(!e.options.overlayClose)return;e.close()}},hasInstances:function(){return Object.keys(a).length>1},isOnlyInstance:function(){return Object.keys(a).length-1===1},move:{pos:{},selected:!1,previous:!1,start:function(e,t){var o=this.pointer(t);this.selected=e,this.selected.$content.css("zIndex",10001),this.pos.top=o.y-this.selected.$content[0].offsetTop,this.pos.left=o.x-this.selected.$content[0].offsetLeft,this.previous?this.previous.$content.css("zIndex",1e4):this.previous=e},drag:function(e){var t=this.pointer(e);this.selected&&(this.selected.$content[0].style.top=t.y+"px",this.selected.$content[0].style.left=t.x+"px")},stop:function(){this.selected&&(this.previous=this.selected,this.selected=!1)},pointer:function(e){var t={x:0,y:0};if("touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type||"touchcancel"===e.type){var o=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];t.x=o.pageX,t.y=o.pageY}else("mousedown"===e.type||"mouseup"===e.type||"mousemove"===e.type||"mouseover"===e.type||"mouseout"===e.type||"mouseenter"===e.type||"mouseleave"===e.type)&&(t.x=e.pageX,t.y=e.pageY);return t}}},p={callback:function(e){if("function"==typeof e)e.apply(this);else if(e!==!1){var t=new Function("return "+e);t()}},escapeSelector:function(e){var t="#"===e.charAt(0),o=/([ !"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~])/g;return t?"#"+e.substring(1).replace(o,"\\$1"):e},getStringVariable:function(e){var t;if(e.indexOf(".")>-1){for(var o=e.split("."),n=window[o[0]],s=1;s<o.length;s++)n=n[o[s]];t=n}else t=window[e];return t},getClassname:function(e){return r.prefix+r.name+"-"+r.classes[e]}};t=e.fn.modal=e.fn.uxrmodal=e.uxrmodal=function(t){var o=this.selector;return"function"==typeof this?new h(null,t,null):this.each(function(){e.data(this,r.data)||e.data(this,r.data,new h(this,t,o))})},t.remove=function(t){var o=e("undefined"==typeof t?"."+p.getClassname("ready"):t);o.each(function(){e(this).data(r.data).remove()})},t.resize=function(){var e=a[a.lastInstance];d.hasInstances()&&e.resize()},t.close=function(){var e=a[a.lastInstance];d.hasInstances()&&e.close()},t.getInstances=function(){return a},t.version="1.3.2",t.settings=c});